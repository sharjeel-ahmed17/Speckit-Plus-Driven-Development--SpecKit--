# Qwen â†’ CCR Auto-Token-Updater-Tool

This tool reads the **Qwen OAuth access_token** from `.qwen/oauth_creds.json` and updates it automatically inside **Claude Code Router (CCR)** `config.json` under the `qwen` provider.

It works on **Windows** and **Linux**.

---

## ğŸ“ Required Folder Location

This script must be run on a system where **both folders already exist**:

```
.qwen/
.claude-code-router/
```

These folders are usually created automatically when:

* You login using Qwen CLI
* You install and configure Claude Code Router (CCR)

---




## ğŸš€ Step-by-Step Setup

### âœ… Step 1: Open Command Prompt / Terminal

#### ğŸ”¹ Windows

Open **Command Prompt** or **PowerShell**:

```
Win + R â†’ cmd â†’ Enter
```

#### ğŸ”¹ Linux

Open **Terminal**:

```
Ctrl + Alt + T
```

---

### âœ… Step 2: Open User Home Folder (IMPORTANT)

âš ï¸ **Important:** `main.py` ko **project folder ke andar nahi**, balkay **direct user home directory** mai rakhna hai (jahan `.qwen` aur `.claude-code-router` already maujood hote hain).

#### ğŸ“‚ Correct Location

##### ğŸ”¹ Windows

```
C:\Users\WASIF\
```

##### ğŸ”¹ Linux

```
/home/youruser/
```

Is directory ke andar hi ye folders hote hain:

```
.qwen/
.claude-code-router/
```

---

### âœ… Step 3: Open Folder in Code Editor

Ab **usi directory** ko code editor mai open karo.

Below are **3 common examples**:

#### 1ï¸âƒ£ VS Code

```
code .
```

#### 2ï¸âƒ£ Cursor

```
cursor .
```

#### 3ï¸âƒ£ Any Editor (manual)

* Open editor
* File â†’ Open Folder
* Select user home folder (jahan `.qwen` folder hai)

---

### âœ… Step 4: Create `main.py`

âš ï¸ **Important:** `main.py` **project folder ke andar nahi** balkay **direct user home directory** mai create hogi.

#### ğŸ“‚ Correct Location

##### ğŸ”¹ Windows

```
C:\Users\WASIF\
â””â”€â”€ main.py
```

##### ğŸ”¹ Linux

```
/home/youruser/
â””â”€â”€ main.py
```





### âœ… Step 5: Copy & Paste Code into `main.py`

Paste the following code into `main.py`:

````python
import json
from pathlib import Path

# UPDATE THESE PATHS IF NEEDED
QWEN_CREDS_PATH = Path(r"C:\Users\WASIF\.qwen\oauth_creds.json")
CLAUDE_CONFIG_PATH = Path(r"C:\Users\WASIF\.claude-code-router\config.json")


def get_access_token():
    if not QWEN_CREDS_PATH.exists():
        raise FileNotFoundError("oauth_creds.json file nahi mili")

    with open(QWEN_CREDS_PATH, "r", encoding="utf-8") as f:
        data = json.load(f)

    if "access_token" not in data:
        raise KeyError("access_token key oauth_creds.json mai nahi hai")

    return data["access_token"]


def update_api_key(new_api_key):
    if not CLAUDE_CONFIG_PATH.exists():
        raise FileNotFoundError("config.json file nahi mili")

    with open(CLAUDE_CONFIG_PATH, "r", encoding="utf-8") as f:
        config = json.load(f)

    providers = config.get("Providers", [])

    for provider in providers:
        if provider.get("name") == "qwen":
            old_key = provider.get("api_key", "N/A")

            print("""
â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘   Developed by SHARJEEL AHMED    â•‘
â•‘   AI â€¢ Full-Stack â€¢ Cloud        â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
""")

            print("\nğŸ”‘ OLD API KEY:")
            print(old_key)

            print("\nğŸ”‘ NEW API KEY (from access_token):")
            print(new_api_key)

            provider["api_key"] = new_api_key
            break
    else:
        raise ValueError("qwen provider config.json mai nahi mila")

    with open(CLAUDE_CONFIG_PATH, "w", encoding="utf-8") as f:
        json.dump(config, f, indent=2)

    print("\nâœ… api_key successfully update ho gaya\n")


def main():
    try:
        access_token = get_access_token()
        update_api_key(access_token)
    except Exception as e:
        print(f"âŒ Error: {e}")


if __name__ == "__main__":
    main()
````

---

### âœ… Step 6: Update Paths (IMPORTANT)

Update these two lines according to **your system user directory**:

#### ğŸ”¹ Windows Example

```
QWEN_CREDS_PATH = Path(r"C:\Users\YOUR_NAME\.qwen\oauth_creds.json")
CLAUDE_CONFIG_PATH = Path(r"C:\Users\YOUR_NAME\.claude-code-router\config.json")
```

#### ğŸ”¹ Linux Example

```
QWEN_CREDS_PATH = Path("/home/youruser/.qwen/oauth_creds.json")
CLAUDE_CONFIG_PATH = Path("/home/youruser/.claude-code-router/config.json")
```

ğŸ‘‰ **Rule:**
Paths should point to the directory where `.qwen` and `.claude-code-router` folders exist.

---

### âœ… Step 7: Run the Script

```
python main.py
```

---

## ğŸ¯ Expected Output

```
ğŸ”‘ OLD API KEY:
xxxxxxxxxx

ğŸ”‘ NEW API KEY (from access_token):
eyJhbGciOi...

âœ… api_key successfully update ho gaya
```

---

## ğŸ§  What This Tool Does (Simple)

```
.qwen/oauth_creds.json
        â†“
reads access_token
        â†“
.claude-code-router/config.json
        â†“
Providers â†’ qwen â†’ api_key updated
```

---

## âœ… Use Case

* Qwen OAuth token auto-sync
* CCR Qwen provider always up-to-date
* No manual copy-paste of API keys

---

## ğŸ” Token Refresh Flow (IMPORTANT)

### ğŸ†• First Time Setup

* Ye setup **sirf pehli baar** required hota hai
* Jab `main.py` create ho jaye aur paths set ho jayein, us ke baad structure ready hota hai

---

### ğŸ”„ Jab Bhi Token Update Karna Ho

Har baar Qwen ka token refresh karne ke liye **ye exact flow follow karo**:

1ï¸âƒ£ **Qwen start karo**

```
qwen
```

2ï¸âƒ£ Qwen start hote hi token generate ho jata hai

3ï¸âƒ£ Ab Qwen ko **stop karo**:

```
Ctrl + C
```

ya

```
/quit
```

4ï¸âƒ£ Ab token `.qwen/oauth_creds.json` mai update ho chuka hota hai

5ï¸âƒ£ Ab Python script run karo:

```
python main.py
```

ğŸ‘‰ Is se naya Qwen `access_token` automatically **CCR ke config.json** mai update ho jaye ga

---

## ğŸ›‘ Notes

* Make sure Qwen installed & logged in ho
* CCR pehle se installed hona chahiye
* Qwen ko start kiye baghair token update nahi hota
* Script ko har token expiry ke baad dobara run kar sakte ho

---

Happy Coding ğŸš€
